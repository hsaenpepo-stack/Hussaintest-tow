<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>HA - Secure Access</title>

  <!-- âœ… Ù„Ùˆ Ø¨Ø§Ù„ÙØ¹Ù„ Ø¯Ø§Ø®Ù„ (Auth Ø£Ùˆ Admin) Ø±Ø¬Ù‘Ø¹Ù‡ Ø¹Ù„Ù‰ next / index / admin -->
  <script>
  (function(){
    const AUTH_KEY  = "HA_AUTH_OK";
    const ADMIN_KEY = "HA_ADMIN_OK";
    const p = new URLSearchParams(location.search);
    const next = p.get("next") || "index.html";

    // Ù„Ùˆ Admin ÙˆØ¨ÙŠÙØªØ­ login => Ø±ÙˆØ­ admin
    if (sessionStorage.getItem(ADMIN_KEY) === "1") {
      location.replace("admin.html");
      return;
    }
    // Ù„Ùˆ Auth Ø¹Ø§Ø¯ÙŠ => Ø±ÙˆØ­ next
    if (sessionStorage.getItem(AUTH_KEY) === "1") {
      location.replace(next);
      return;
    }
  })();
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0b1016;
  --card:#121722;
  --accent:#ff9d2f;
  --teal:#14e0c3;
  --text:#fff;
  --muted:#bfc7d6;
  --danger:#ff5c5c;
  --ok:#5CFFB0;
  --radius:18px;
  --shadow:0 18px 55px rgba(0,0,0,0.45);
}

*{box-sizing:border-box;font-family:'Cairo',sans-serif;}
body{
  margin:0; min-height:100vh;
  background:
    radial-gradient(circle at 20% 30%, rgba(20,224,195,.14), transparent 42%),
    radial-gradient(circle at 80% 40%, rgba(255,157,47,.16), transparent 42%),
    var(--bg);
  display:grid; place-items:center;
  color:var(--text);
  overflow:hidden;
}

/* Ø®Ù„ÙÙŠØ© Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© */
.bg{
  position:fixed; inset:0;
  background:url("assets/bg/login-bg.jpg") center/cover no-repeat;
  opacity:.08;
  pointer-events:none;
}

/* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ù‡Ø§Ø¯ÙŠ (Blob) */
.blob{
  position:fixed; width:520px; height:520px;
  filter: blur(40px);
  opacity:.22;
  border-radius:50%;
  background: radial-gradient(circle at 30% 30%, rgba(20,224,195,.9), transparent 55%),
              radial-gradient(circle at 70% 70%, rgba(255,157,47,.9), transparent 55%);
  animation: drift 10s ease-in-out infinite alternate;
  pointer-events:none;
}
.blob.b2{
  width:620px;height:620px;opacity:.16;
  animation-duration: 13s;
  transform: translate(220px, 140px);
}
@keyframes drift{
  from{transform:translate(-180px,-120px) scale(1);}
  to{transform:translate(-120px,-160px) scale(1.06);}
}

.card{
  width:min(540px, 92%);
  background:rgba(18,23,34,.88);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:var(--shadow);
  padding:28px;
  border-radius:var(--radius);
  position:relative;
}

.brandRow{
  display:flex; align-items:center; gap:12px;
  margin-bottom:14px;
}
.logo{
  width:46px;height:46px;border-radius:14px;
  object-fit:cover;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
}
.brandTitle{
  display:flex; flex-direction:column; line-height:1.2;
}
.brandTitle b{font-size:16px;font-weight:900;}
.brandTitle span{font-size:12px;color:var(--muted);font-weight:700;}

h1{
  margin:10px 0 0;
  font-size:34px;
  font-weight:900;
}
.sub{
  margin-top:6px;
  color:var(--muted);
  font-weight:700;
  line-height:1.7;
}

.inputWrap{
  margin-top:22px;
  position:relative;
}

input{
  width:100%;
  padding:14px 48px 14px 14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.22);
  color:#fff;
  font-weight:900;
  outline:none;
  transition:.2s;
}
input:focus{
  border-color: rgba(20,224,195,.55);
  box-shadow: 0 0 0 4px rgba(20,224,195,.10);
}

.eye{
  position:absolute;
  left:14px;
  top:50%;
  transform:translateY(-50%);
  cursor:pointer;
  font-size:18px;
  opacity:.75;
  user-select:none;
}

.btn{
  margin-top:14px;
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  font-weight:900;
  cursor:pointer;
  color:#1a0f00;
  background: linear-gradient(90deg, rgba(255,157,47,1), rgba(255,120,0,1));
  box-shadow:
    0 14px 40px rgba(255,157,47,.22),
    0 0 0 1px rgba(255,255,255,.08) inset;
  transition:.18s;
  position:relative;
  overflow:hidden;
}

/* Glow â€œØªÙ‚Ù†ÙŠâ€ */
.btn::after{
  content:"";
  position:absolute; inset:-40%;
  background: radial-gradient(circle, rgba(255,255,255,.35), transparent 55%);
  transform: translateX(-40%);
  opacity:.35;
  transition:.25s;
}
.btn:hover{ transform:translateY(-1px); filter:brightness(1.03); }
.btn:hover::after{ transform: translateX(20%); opacity:.45; }

.btn:disabled{
  opacity:.55;
  cursor:not-allowed;
  transform:none;
}

.row{
  display:flex; justify-content:space-between; gap:10px;
  margin-top:10px;
  color:var(--muted);
  font-weight:800;
  font-size:12px;
}

.badge{
  display:inline-flex; align-items:center; gap:8px;
  padding:8px 10px; border-radius:999px;
  background:rgba(20,224,195,.10);
  border:1px solid rgba(20,224,195,.28);
  color:var(--teal);
}

.mode{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
  margin-top:14px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.08);
  background:rgba(0,0,0,.16);
}
.mode b{font-size:12px;}
.switch{
  display:flex; gap:8px;
}
.pill{
  padding:8px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  color:var(--muted);
  cursor:pointer;
  font-weight:900;
  font-size:12px;
  transition:.2s;
  user-select:none;
}
.pill.active{
  color:#001018;
  background:rgba(20,224,195,.95);
  border-color:transparent;
}

.msg{
  margin-top:12px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  font-weight:900;
  display:none;
}
.msg.err{
  display:block;
  border-color: rgba(255,92,92,.35);
  background: rgba(255,92,92,.08);
  color:#ffd0d0;
}
.msg.ok{
  display:block;
  border-color: rgba(92,255,176,.35);
  background: rgba(92,255,176,.08);
  color:#d8ffe9;
}

/* Shake Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£ */
.shake{
  animation: shake .22s linear 0s 2;
}
@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-8px)}
  50%{transform:translateX(8px)}
  75%{transform:translateX(-6px)}
  100%{transform:translateX(0)}
}
</style>
</head>

<body>

<div class="bg"></div>
<div class="blob"></div>
<div class="blob b2"></div>

<div class="card" id="card">
  <div class="brandRow">
    <img class="logo" src="assets/hero/hero.png" alt="HA" loading="eager" decoding="async">
    <div class="brandTitle">
      <b>HA - Visual School</b>
      <span>Secure Access</span>
    </div>
  </div>

  <h1>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ</h1>
  <div class="sub">ÙƒÙ„ Ø³Ù†Ø© ÙˆØ£Ù†ØªÙ… Ø·ÙŠØ¨ÙŠÙ† â€” Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</div>

  <!-- âœ… Ø§Ø®ØªÙŠØ§Ø± ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
  <div class="mode">
    <b id="modeLabel">ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„: Ù…Ø³ØªØ®Ø¯Ù…</b>
    <div class="switch">
      <span class="pill active" id="pillUser">User</span>
      <span class="pill" id="pillAdmin">Admin</span>
    </div>
  </div>

  <div class="inputWrap">
    <input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" autocomplete="current-password" />
    <span class="eye" id="eye" title="Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡">ğŸ‘</span>
  </div>

  <button class="btn" id="btn">Ø¯Ø®ÙˆÙ„</button>

  <div class="row">
    <span class="badge">ğŸ”’ Ø¯Ø®ÙˆÙ„ Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø´ØªØ±ÙƒÙŠÙ†</span>
    <span id="tries">Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©: 5</span>
  </div>

  <div id="msg" class="msg"></div>
</div>

<script>
/* =========================
   âœ… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (ØºÙŠÙ‘Ø±ÙŠÙ‡Ù… Ø¹Ù†Ø¯Ùƒ)
========================= */
const PASSWORD_USER  = "HA-2026";
const PASSWORD_ADMIN = "HA-ADMIN";

/* âœ… Ù…ÙØ§ØªÙŠØ­ Ø¬Ù„Ø³Ø© Ù…Ù†ÙØµÙ„Ø© */
const AUTH_KEY  = "HA_AUTH_OK";
const ADMIN_KEY = "HA_ADMIN_OK";

/* ========================= */
const $ = (id)=>document.getElementById(id);
const card = $("card");
const pass = $("pass");
const btn  = $("btn");
const msg  = $("msg");
const eye  = $("eye");
const triesEl = $("tries");

const pillUser = $("pillUser");
const pillAdmin = $("pillAdmin");
const modeLabel = $("modeLabel");

let mode = "user"; // user | admin
let tries = 5;
let lockedUntil = 0;

function setMode(nextMode){
  mode = nextMode;
  pillUser.classList.toggle("active", mode==="user");
  pillAdmin.classList.toggle("active", mode==="admin");
  modeLabel.textContent = "ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø®ÙˆÙ„: " + (mode==="admin" ? "Ø£Ø¯Ù…Ù†" : "Ù…Ø³ØªØ®Ø¯Ù…");
  pass.placeholder = mode==="admin" ? "ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø£Ø¯Ù…Ù†" : "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±";
  setMsg("", "");
}
pillUser.addEventListener("click", ()=>setMode("user"));
pillAdmin.addEventListener("click", ()=>setMode("admin"));

function safeNext(){
  const p = new URLSearchParams(location.search);
  let next = (p.get("next") || "index.html").trim();

  // Ø§Ù…Ù†Ø¹ÙŠ Ø£ÙŠ Ù…Ø³Ø§Ø± Ø®Ø§Ø±Ø¬ÙŠ/ØºØ±ÙŠØ¨
  if(!next || next.includes("://") || next.startsWith("//") || next.startsWith("javascript:")) {
    next = "index.html";
  }

  // Ø§Ù…Ù†Ø¹ÙŠ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù€ login Ù†ÙØ³Ù‡
  if(next.toLowerCase().includes("login.html")) next = "index.html";

  // Ù„Ùˆ Ø­Ø¯ Ø¨Ø¹Øª Ù…Ø³Ø§Ø± ÙƒØ§Ù…Ù„: Ø®Ø¯ÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø¨Ø³
  if(next.includes("/")) next = next.split("/").pop();

  return next || "index.html";
}

function setMsg(text, type){
  msg.className = "msg " + (type || "");
  msg.textContent = text || "";
  msg.style.display = text ? "block" : "none";
}

function shake(){
  card.classList.remove("shake");
  void card.offsetWidth;
  card.classList.add("shake");
}

eye.addEventListener("click", ()=>{
  pass.type = pass.type === "password" ? "text" : "password";
});

function now(){ return Date.now(); }

function lockFor(ms){
  lockedUntil = now() + ms;
  btn.disabled = true;
  const iv = setInterval(()=>{
    const left = Math.max(0, lockedUntil - now());
    const s = Math.ceil(left/1000);

    if(left <= 0){
      clearInterval(iv);
      btn.disabled = false;
      setMsg("", "");
      btn.textContent = "Ø¯Ø®ÙˆÙ„";
      return;
    }
    setMsg("ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…Ø¤Ù‚ØªÙ‹Ø§: " + s + " Ø«Ø§Ù†ÙŠØ©", "err");
  }, 250);
}

function updateTries(){
  triesEl.textContent = "Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©: " + tries;
}

function goUser(){
  sessionStorage.setItem(AUTH_KEY, "1");
  sessionStorage.removeItem(ADMIN_KEY);
  const nextPage = safeNext();
  window.location.replace("./" + nextPage);
}

function goAdmin(){
  sessionStorage.setItem(AUTH_KEY, "1");
  sessionStorage.setItem(ADMIN_KEY, "1");
  window.location.replace("./admin.html");
}

async function doLogin(){
  if(now() < lockedUntil) return;

  const value = (pass.value || "").trim();
  if(!value){
    shake();
    setMsg("Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø£ÙˆÙ„Ù‹Ø§.", "err");
    pass.focus();
    return;
  }

  btn.disabled = true;
  const oldText = btn.textContent;
  btn.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...";
  setMsg("", "");

  await new Promise(r=>setTimeout(r, 320));

  const okUser  = (mode==="user"  && value === PASSWORD_USER);
  const okAdmin = (mode==="admin" && value === PASSWORD_ADMIN);

  if(okUser){
    setMsg("ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…", "ok");
    setTimeout(goUser, 260);
    return;
  }
  if(okAdmin){
    setMsg("ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ£Ø¯Ù…Ù† âœ…", "ok");
    setTimeout(goAdmin, 260);
    return;
  }

  // ØºÙ„Ø·
  tries -= 1;
  updateTries();
  shake();
  setMsg("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.", "err");

  btn.disabled = false;
  btn.textContent = oldText;

  if(tries <= 0){
    tries = 5;
    updateTries();
    lockFor(15000);
  }
}

btn.addEventListener("click", doLogin);
pass.addEventListener("keydown", (e)=>{
  if(e.key === "Enter") doLogin();
});

updateTries();
</script>

</body>
</html>